#%%
#import gempyExplicit
import pygeoiga as gn
import numpy as np

#%%
def test_create1d():
    points1D = np.array([[30,0,15],
                         [30,5,15],
                         [30,10,15],
                         [25,10,15],
                         [25,5,15],
                         [25,0,15]])
    knot10=np.array([0,0,0,0.3,0.5,0.7,1,1,1])#D1
    weight1D=np.array([[[1],[1],[1],[1],[1],[1]]])
    resolution = 30

    #nurb1 = gn.NURB(points1D, [knot10], weight1D, resolution=resolution, engine="c++")
    #print(nurb1.degree, nurb1.dim)

    nurb2 = gn.NURB(points1D, [knot10], weight1D, resolution=resolution, engine="python")
    print(nurb2.degree, nurb2.dim)


def test_create2d():
    points2D = np.array([[[150,0,50],[150,25,50],[150,50,50],[140,50,50],[140,25,50],[140,0,50]],
                         [[150,0,30],[150,25,30],[150,50,30],[140,50,30],[140,25,30],[140,0,30]],
                         [[150,0,15],[150,25,15],[150,50,15],[140,50,15],[140,25,15],[140,0,15]],
                         [[150,0,0],[150,25,0],[150,50,0],[140,50,0],[140,25,0],[140,0,0]]])

    knot1 = np.array([0, 0, 0, 0, 1, 1, 1, 1])  # D1
    knot2 = np.array([0,0,0,0.3,0.5,0.7,1,1,1])#D2
    #knot = np.asarray((knot1, knot2))
    weight2D=np.array([[[1],[1],[1],[1],[1],[1]],
                    [[1],[1],[1],[1],[1],[1]],
                    [[1],[1],[1],[1],[1],[1]],
                    [[1], [1], [1], [1], [1],[1]]])
    resolution = 30
    #nurb2 = gn.NURB(points2D,[knot1, knot2],weight2D, resolution=resolution, engine = "c++")
    #print(nurb2.model)
    #print(nurb2.degree, nurb2.dim)

    nurb3 = gn.NURB(points2D, [knot1, knot2], weight2D, resolution=resolution, engine="python")
    print(nurb3.model)
    print(nurb3.degree, nurb3.dim)

def test_create3d():
    points3D = np.array([[[[100, 0, 50],[100, 50, 50],[50, 50, 50],[45, 20, 50],[15, 20, 50],[15, 50, 50]],
                      [[100, 0, 30],[100, 50, 30],[50, 50, 30],[45, 20, 30],[15, 20, 30],[15, 50, 30]],
                      [[100, 0, 15],[100, 50, 15],[50, 50, 15],[45, 20, 15],[15, 20, 15], [15, 50, 15]],
                      [[100, 0, 0], [100, 50, 0], [50, 50, 0],[ 45, 20, 0], [15, 20, 0], [ 15, 50, 0]]],

                     [[[95, 0, 50], [95, 45, 50], [55, 45, 50], [50, 15, 50], [10, 15, 50], [10, 50, 50]],
                      [[95, 0, 30], [95, 45, 30], [55, 45, 30], [50, 15, 30], [10, 15, 30], [10, 50, 30]],
                      [[95, 0, 15], [95, 45, 15], [55, 45, 15], [50, 15, 15], [10, 15, 15], [10, 50, 15]],
                      [[95, 0, 0],  [95, 45, 0],  [55, 45, 0],  [50, 15, 0], [10, 15, 0], [10, 50, 0]]],

                     [[[90, 0, 50], [90, 40, 50], [60, 40, 50], [55, 10, 50], [5, 10, 50], [5, 50, 50]],
                      [[90, 0, 30], [90, 40, 30], [60, 40, 30], [55, 10, 30], [5, 10, 30], [5, 50, 30]],
                      [[90, 0, 15], [90, 40, 15], [60, 40, 15], [55, 10, 15], [5, 10, 15], [5, 50, 15]],
                      [[90, 0, 0], [90, 40, 0],  [60, 40, 0],   [55, 10, 0],  [5, 10, 0],  [5, 50, 0]]],

                     [[[85, 0, 50], [85, 35, 50], [65, 35, 50], [60, 5, 50], [0, 5, 50], [0, 50, 50]],
                      [[85, 0, 30], [85, 35, 30], [65, 35, 30], [60, 5, 30], [0, 5, 30], [0, 50, 30]],
                      [[85, 0, 15], [85, 35, 15], [65, 35, 15], [60, 5, 15], [0, 5, 15], [0, 50, 15]],
                      [[85, 0, 0], [85, 35, 0], [65, 35, 0],  [60, 5, 0],  [0, 5, 0], [0, 50, 0]]],
                                                                                             ])
    knot11 = np.array([0, 0, 0, 0, 1, 1, 1, 1])  # D1
    knot22 = np.array([0, 0, 0, 0, 1, 1, 1, 1]) #D2
    knot33 = np.array([0, 0, 0, 0.3, 0.5, 0.7, 1, 1, 1])  # D3

    weight3D=np.ones((points3D.shape[0],points3D.shape[1], points3D.shape[2], 1))

    knot = np.asarray((knot11,knot22,knot33))
    nurb3 = gn.NURB(points3D, knot, weight3D, engine="c++")
    print(nurb3.model)
    print(nurb3.degree, nurb3.dim)





